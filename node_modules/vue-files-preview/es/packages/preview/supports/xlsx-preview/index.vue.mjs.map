{"version":3,"file":"index.vue.mjs","sources":["../../../../../../packages/preview/supports/xlsx-preview/index.vue"],"sourcesContent":["<script lang=\"ts\" setup>\nimport VueOfficeExcel from '@vue-office/excel'\nimport '@vue-office/excel/lib/index.css'\nimport {ref, watch} from 'vue'\nimport type {PreviewProps} from '../../preview.interface'\nimport {getFileRenderByFile} from '../../utils/utils'\n\nconst props = withDefaults(\n    defineProps<\n        PreviewProps & {\n      width?: string\n      height?: string\n    }\n    >(),\n    {\n      url: () => null,\n      file: () => null,\n    },\n)\nconst fileRender = ref(null)\nwatch(\n    () => props.file,\n    (file) => {\n      if (file) {\n        getFileRenderByFile(file).then(render => (fileRender.value = render))\n      }\n    },\n    {immediate: true},\n)\n\nfunction renderedHandler(): void {\n  console.log('渲染完成')\n}\n\nfunction errorHandler(): void {\n  console.log('渲染失败')\n}\n</script>\n\n<template>\n  <div class=\"xlsx-preview\">\n    <VueOfficeExcel :src=\"fileRender\" @rendered=\"renderedHandler\" @error=\"errorHandler\"/>\n  </div>\n</template>\n\n<style scoped lang=\"scss\">\n\n</style>\n"],"names":["props","__props","fileRender","ref","watch","file","getFileRenderByFile","render","renderedHandler","errorHandler"],"mappings":";;;;;;;;;;;;;;AAOA,UAAMA,IAAQC,GAYRC,IAAaC,EAAI,IAAI;AAC3B,IAAAC;AAAA,MACI,MAAMJ,EAAM;AAAA,MACZ,CAACK,MAAS;AACR,QAAIA,KACFC,EAAoBD,CAAI,EAAE,KAAK,CAAWE,MAAAL,EAAW,QAAQK,CAAO;AAAA,MAExE;AAAA,MACA,EAAC,WAAW,GAAI;AAAA,IAAA;AAGpB,aAASC,IAAwB;AAC/B,cAAQ,IAAI,MAAM;AAAA,IACpB;AAEA,aAASC,IAAqB;AAC5B,cAAQ,IAAI,MAAM;AAAA,IACpB;;;;;;;;;;"}