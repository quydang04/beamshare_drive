"use strict";const d=require("../common/utils.js"),E=/['"]/,q=/['"]/g,v="â€™";function m(t,n,e){return t.slice(0,n)+e+t.slice(n+1)}function O(t,n){let e;const i=[];for(let l=0;l<t.length;l++){const c=t[l],g=t[l].level;for(e=i.length-1;e>=0&&!(i[e].level<=g);e--);if(i.length=e+1,c.type!=="text")continue;let h=c.content,r=0,S=h.length;e:for(;r<S;){q.lastIndex=r;const o=q.exec(h);if(!o)break;let f=!0,s=!0;r=o.index+1;const x=o[0]==="'";let a=32;if(o.index-1>=0)a=h.charCodeAt(o.index-1);else for(e=l-1;e>=0&&!(t[e].type==="softbreak"||t[e].type==="hardbreak");e--)if(t[e].content){a=t[e].content.charCodeAt(t[e].content.length-1);break}let u=32;if(r<S)u=h.charCodeAt(r);else for(e=l+1;e<t.length&&!(t[e].type==="softbreak"||t[e].type==="hardbreak");e++)if(t[e].content){u=t[e].content.charCodeAt(0);break}const k=d.isMdAsciiPunct(a)||d.isPunctChar(String.fromCharCode(a)),A=d.isMdAsciiPunct(u)||d.isPunctChar(String.fromCharCode(u)),P=d.isWhiteSpace(a),y=d.isWhiteSpace(u);if(y?f=!1:A&&(P||k||(f=!1)),P?s=!1:k&&(y||A||(s=!1)),u===34&&o[0]==='"'&&a>=48&&a<=57&&(s=f=!1),f&&s&&(f=k,s=A),!f&&!s){x&&(c.content=m(c.content,o.index,v));continue}if(s)for(e=i.length-1;e>=0;e--){let p=i[e];if(i[e].level<g)break;if(p.single===x&&i[e].level===g){p=i[e];let C,b;x?(C=n.md.options.quotes[2],b=n.md.options.quotes[3]):(C=n.md.options.quotes[0],b=n.md.options.quotes[1]),c.content=m(c.content,o.index,b),t[p.token].content=m(t[p.token].content,p.pos,C),r+=b.length-1,p.token===l&&(r+=C.length-1),h=c.content,S=h.length,i.length=e;continue e}}f?i.push({token:l,pos:o.index,single:x,level:g}):s&&x&&(c.content=m(c.content,o.index,v))}}}function T(t){if(t.md.options.typographer)for(let n=t.tokens.length-1;n>=0;n--)t.tokens[n].type!=="inline"||!E.test(t.tokens[n].content)||O(t.tokens[n].children,t)}module.exports=T;
//# sourceMappingURL=smartquotes.js.map
