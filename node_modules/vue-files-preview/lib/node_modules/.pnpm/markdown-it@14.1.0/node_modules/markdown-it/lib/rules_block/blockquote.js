"use strict";const g=require("../common/utils.js");function E(o,r,d,I){let u=o.bMarks[r]+o.tShift[r],b=o.eMarks[r];const A=o.lineMax;if(o.sCount[r]-o.blkIndent>=4||o.src.charCodeAt(u)!==62)return!1;if(I)return!0;const f=[],i=[],h=[],k=[],s=o.md.block.ruler.getRules("blockquote"),T=o.parentType;o.parentType="blockquote";let M=!1,n;for(n=r;n<d;n++){const l=o.sCount[n]<o.blkIndent;if(u=o.bMarks[n]+o.tShift[n],b=o.eMarks[n],u>=b)break;if(o.src.charCodeAt(u++)===62&&!l){let c=o.sCount[n]+1,e,p;o.src.charCodeAt(u)===32?(u++,c++,p=!1,e=!0):o.src.charCodeAt(u)===9?(e=!0,(o.bsCount[n]+c)%4===3?(u++,c++,p=!1):p=!0):e=!1;let C=c;for(f.push(o.bMarks[n]),o.bMarks[n]=u;u<b;){const q=o.src.charCodeAt(u);if(g.isSpace(q))q===9?C+=4-(C+o.bsCount[n]+(p?1:0))%4:C++;else break;u++}M=u>=b,i.push(o.bsCount[n]),o.bsCount[n]=o.sCount[n]+1+(e?1:0),h.push(o.sCount[n]),o.sCount[n]=C-c,k.push(o.tShift[n]),o.tShift[n]=u-o.bMarks[n];continue}if(M)break;let m=!1;for(let c=0,e=s.length;c<e;c++)if(s[c](o,n,d,!0)){m=!0;break}if(m){o.lineMax=n,o.blkIndent!==0&&(f.push(o.bMarks[n]),i.push(o.bsCount[n]),k.push(o.tShift[n]),h.push(o.sCount[n]),o.sCount[n]-=o.blkIndent);break}f.push(o.bMarks[n]),i.push(o.bsCount[n]),k.push(o.tShift[n]),h.push(o.sCount[n]),o.sCount[n]=-1}const y=o.blkIndent;o.blkIndent=0;const x=o.push("blockquote_open","blockquote",1);x.markup=">";const S=[r,0];x.map=S,o.md.block.tokenize(o,r,n);const _=o.push("blockquote_close","blockquote",-1);_.markup=">",o.lineMax=A,o.parentType=T,S[1]=o.line;for(let l=0;l<k.length;l++)o.bMarks[l+r]=f[l],o.tShift[l+r]=k[l],o.sCount[l+r]=h[l],o.bsCount[l+r]=i[l];return o.blkIndent=y,!0}module.exports=E;
//# sourceMappingURL=blockquote.js.map
