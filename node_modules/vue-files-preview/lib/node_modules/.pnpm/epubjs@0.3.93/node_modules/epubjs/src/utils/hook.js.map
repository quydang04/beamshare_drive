{"version":3,"file":"hook.js","sources":["../../../../../../../../../node_modules/.pnpm/epubjs@0.3.93/node_modules/epubjs/src/utils/hook.js"],"sourcesContent":["/**\n * Hooks allow for injecting functions that must all complete in order before finishing\n * They will execute in parallel but all must finish before continuing\n * Functions may return a promise if they are async.\n * @param {any} context scope of this\n * @example this.content = new EPUBJS.Hook(this);\n */\nclass Hook {\n\tconstructor(context){\n\t\tthis.context = context || this;\n\t\tthis.hooks = [];\n\t}\n\n\t/**\n\t * Adds a function to be run before a hook completes\n\t * @example this.content.register(function(){...});\n\t */\n\tregister(){\n\t\tfor(var i = 0; i < arguments.length; ++i) {\n\t\t\tif (typeof arguments[i]  === \"function\") {\n\t\t\t\tthis.hooks.push(arguments[i]);\n\t\t\t} else {\n\t\t\t\t// unpack array\n\t\t\t\tfor(var j = 0; j < arguments[i].length; ++j) {\n\t\t\t\t\tthis.hooks.push(arguments[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Removes a function\n\t * @example this.content.deregister(function(){...});\n\t */\n\tderegister(func){\n\t\tlet hook;\n\t\tfor (let i = 0; i < this.hooks.length; i++) {\n\t\t\thook = this.hooks[i];\n\t\t\tif (hook === func) {\n\t\t\t\tthis.hooks.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Triggers a hook to run all functions\n\t * @example this.content.trigger(args).then(function(){...});\n\t */\n\ttrigger(){\n\t\tvar args = arguments;\n\t\tvar context = this.context;\n\t\tvar promises = [];\n\n\t\tthis.hooks.forEach(function(task) {\n\t\t\ttry {\n\t\t\t\tvar executing = task.apply(context, args);\n\t\t\t} catch (err) {\n\t\t\t\tconsole.log(err);\n\t\t\t}\n\n\t\t\tif(executing && typeof executing[\"then\"] === \"function\") {\n\t\t\t\t// Task is a function that returns a promise\n\t\t\t\tpromises.push(executing);\n\t\t\t}\n\t\t\t// Otherwise Task resolves immediately, continue\n\t\t});\n\n\n\t\treturn Promise.all(promises);\n\t}\n\n\t// Adds a function to be run before a hook completes\n\tlist(){\n\t\treturn this.hooks;\n\t}\n\n\tclear(){\n\t\treturn this.hooks = [];\n\t}\n}\nexport default Hook;\n"],"names":["Hook","context","i","j","func","hook","args","promises","task","executing","err"],"mappings":"aAOA,MAAMA,CAAK,CACV,YAAYC,EAAQ,CACnB,KAAK,QAAUA,GAAW,KAC1B,KAAK,MAAQ,EACb,CAMD,UAAU,CACT,QAAQC,EAAI,EAAGA,EAAI,UAAU,OAAQ,EAAEA,EACtC,GAAI,OAAO,UAAUA,CAAC,GAAO,WAC5B,KAAK,MAAM,KAAK,UAAUA,CAAC,CAAC,MAG5B,SAAQC,EAAI,EAAGA,EAAI,UAAUD,CAAC,EAAE,OAAQ,EAAEC,EACzC,KAAK,MAAM,KAAK,UAAUD,CAAC,EAAEC,CAAC,CAAC,CAIlC,CAMD,WAAWC,EAAK,CACf,IAAIC,EACJ,QAASH,EAAI,EAAGA,EAAI,KAAK,MAAM,OAAQA,IAEtC,GADAG,EAAO,KAAK,MAAMH,CAAC,EACfG,IAASD,EAAM,CAClB,KAAK,MAAM,OAAOF,EAAG,CAAC,EACtB,KACA,CAEF,CAMD,SAAS,CACR,IAAII,EAAO,UACPL,EAAU,KAAK,QACfM,EAAW,CAAA,EAEf,YAAK,MAAM,QAAQ,SAASC,EAAM,CACjC,GAAI,CACH,IAAIC,EAAYD,EAAK,MAAMP,EAASK,CAAI,CACxC,OAAQI,EAAK,CACb,QAAQ,IAAIA,CAAG,CACf,CAEED,GAAa,OAAOA,EAAU,MAAY,YAE5CF,EAAS,KAAKE,CAAS,CAG3B,CAAG,EAGM,QAAQ,IAAIF,CAAQ,CAC3B,CAGD,MAAM,CACL,OAAO,KAAK,KACZ,CAED,OAAO,CACN,OAAO,KAAK,MAAQ,EACpB,CACF","x_google_ignoreList":[0]}