{"version":3,"file":"contents.js","sources":["../../../../../../../../node_modules/.pnpm/epubjs@0.3.93/node_modules/epubjs/src/contents.js"],"sourcesContent":["import EventEmitter from \"event-emitter\";\nimport {isNumber, prefixed, borders, defaults} from \"./utils/core\";\nimport EpubCFI from \"./epubcfi\";\nimport Mapping from \"./mapping\";\nimport {replaceLinks} from \"./utils/replacements\";\nimport { EPUBJS_VERSION, EVENTS, DOM_EVENTS } from \"./utils/constants\";\n\nconst hasNavigator = typeof (navigator) !== \"undefined\";\n\nconst isChrome = hasNavigator && /Chrome/.test(navigator.userAgent);\nconst isWebkit = hasNavigator && !isChrome && /AppleWebKit/.test(navigator.userAgent);\n\nconst ELEMENT_NODE = 1;\nconst TEXT_NODE = 3;\n\n/**\n\t* Handles DOM manipulation, queries and events for View contents\n\t* @class\n\t* @param {document} doc Document\n\t* @param {element} content Parent Element (typically Body)\n\t* @param {string} cfiBase Section component of CFIs\n\t* @param {number} sectionIndex Index in Spine of Conntent's Section\n\t*/\nclass Contents {\n\tconstructor(doc, content, cfiBase, sectionIndex) {\n\t\t// Blank Cfi for Parsing\n\t\tthis.epubcfi = new EpubCFI();\n\n\t\tthis.document = doc;\n\t\tthis.documentElement =  this.document.documentElement;\n\t\tthis.content = content || this.document.body;\n\t\tthis.window = this.document.defaultView;\n\n\t\tthis._size = {\n\t\t\twidth: 0,\n\t\t\theight: 0\n\t\t};\n\n\t\tthis.sectionIndex = sectionIndex || 0;\n\t\tthis.cfiBase = cfiBase || \"\";\n\n\t\tthis.epubReadingSystem(\"epub.js\", EPUBJS_VERSION);\n\t\tthis.called = 0;\n\t\tthis.active = true;\n\t\tthis.listeners();\n\t}\n\n\t/**\n\t\t* Get DOM events that are listened for and passed along\n\t\t*/\n\tstatic get listenedEvents() {\n\t\treturn DOM_EVENTS;\n\t}\n\n\t/**\n\t\t* Get or Set width\n\t\t* @param {number} [w]\n\t\t* @returns {number} width\n\t\t*/\n\twidth(w) {\n\t\t// var frame = this.documentElement;\n\t\tvar frame = this.content;\n\n\t\tif (w && isNumber(w)) {\n\t\t\tw = w + \"px\";\n\t\t}\n\n\t\tif (w) {\n\t\t\tframe.style.width = w;\n\t\t\t// this.content.style.width = w;\n\t\t}\n\n\t\treturn parseInt(this.window.getComputedStyle(frame)[\"width\"]);\n\n\n\t}\n\n\t/**\n\t\t* Get or Set height\n\t\t* @param {number} [h]\n\t\t* @returns {number} height\n\t\t*/\n\theight(h) {\n\t\t// var frame = this.documentElement;\n\t\tvar frame = this.content;\n\n\t\tif (h && isNumber(h)) {\n\t\t\th = h + \"px\";\n\t\t}\n\n\t\tif (h) {\n\t\t\tframe.style.height = h;\n\t\t\t// this.content.style.height = h;\n\t\t}\n\n\t\treturn parseInt(this.window.getComputedStyle(frame)[\"height\"]);\n\n\t}\n\n\t/**\n\t\t* Get or Set width of the contents\n\t\t* @param {number} [w]\n\t\t* @returns {number} width\n\t\t*/\n\tcontentWidth(w) {\n\n\t\tvar content = this.content || this.document.body;\n\n\t\tif (w && isNumber(w)) {\n\t\t\tw = w + \"px\";\n\t\t}\n\n\t\tif (w) {\n\t\t\tcontent.style.width = w;\n\t\t}\n\n\t\treturn parseInt(this.window.getComputedStyle(content)[\"width\"]);\n\n\n\t}\n\n\t/**\n\t\t* Get or Set height of the contents\n\t\t* @param {number} [h]\n\t\t* @returns {number} height\n\t\t*/\n\tcontentHeight(h) {\n\n\t\tvar content = this.content || this.document.body;\n\n\t\tif (h && isNumber(h)) {\n\t\t\th = h + \"px\";\n\t\t}\n\n\t\tif (h) {\n\t\t\tcontent.style.height = h;\n\t\t}\n\n\t\treturn parseInt(this.window.getComputedStyle(content)[\"height\"]);\n\n\t}\n\n\t/**\n\t\t* Get the width of the text using Range\n\t\t* @returns {number} width\n\t\t*/\n\ttextWidth() {\n\t\tlet rect;\n\t\tlet width;\n\t\tlet range = this.document.createRange();\n\t\tlet content = this.content || this.document.body;\n\t\tlet border = borders(content);\n\n\t\t// Select the contents of frame\n\t\trange.selectNodeContents(content);\n\n\t\t// get the width of the text content\n\t\trect = range.getBoundingClientRect();\n\t\twidth = rect.width;\n\n\t\tif (border && border.width) {\n\t\t\twidth += border.width;\n\t\t}\n\n\t\treturn Math.round(width);\n\t}\n\n\t/**\n\t\t* Get the height of the text using Range\n\t\t* @returns {number} height\n\t\t*/\n\ttextHeight() {\n\t\tlet rect;\n\t\tlet height;\n\t\tlet range = this.document.createRange();\n\t\tlet content = this.content || this.document.body;\n\n\t\trange.selectNodeContents(content);\n\n\t\trect = range.getBoundingClientRect();\n\t\theight = rect.bottom;\n\n\t\treturn Math.round(height);\n\t}\n\n\t/**\n\t\t* Get documentElement scrollWidth\n\t\t* @returns {number} width\n\t\t*/\n\tscrollWidth() {\n\t\tvar width = this.documentElement.scrollWidth;\n\n\t\treturn width;\n\t}\n\n\t/**\n\t\t* Get documentElement scrollHeight\n\t\t* @returns {number} height\n\t\t*/\n\tscrollHeight() {\n\t\tvar height = this.documentElement.scrollHeight;\n\n\t\treturn height;\n\t}\n\n\t/**\n\t\t* Set overflow css style of the contents\n\t\t* @param {string} [overflow]\n\t\t*/\n\toverflow(overflow) {\n\n\t\tif (overflow) {\n\t\t\tthis.documentElement.style.overflow = overflow;\n\t\t}\n\n\t\treturn this.window.getComputedStyle(this.documentElement)[\"overflow\"];\n\t}\n\n\t/**\n\t\t* Set overflowX css style of the documentElement\n\t\t* @param {string} [overflow]\n\t\t*/\n\toverflowX(overflow) {\n\n\t\tif (overflow) {\n\t\t\tthis.documentElement.style.overflowX = overflow;\n\t\t}\n\n\t\treturn this.window.getComputedStyle(this.documentElement)[\"overflowX\"];\n\t}\n\n\t/**\n\t\t* Set overflowY css style of the documentElement\n\t\t* @param {string} [overflow]\n\t\t*/\n\toverflowY(overflow) {\n\n\t\tif (overflow) {\n\t\t\tthis.documentElement.style.overflowY = overflow;\n\t\t}\n\n\t\treturn this.window.getComputedStyle(this.documentElement)[\"overflowY\"];\n\t}\n\n\t/**\n\t\t* Set Css styles on the contents element (typically Body)\n\t\t* @param {string} property\n\t\t* @param {string} value\n\t\t* @param {boolean} [priority] set as \"important\"\n\t\t*/\n\tcss(property, value, priority) {\n\t\tvar content = this.content || this.document.body;\n\n\t\tif (value) {\n\t\t\tcontent.style.setProperty(property, value, priority ? \"important\" : \"\");\n\t\t} else {\n\t\t\tcontent.style.removeProperty(property);\n\t\t}\n\n\t\treturn this.window.getComputedStyle(content)[property];\n\t}\n\n\t/**\n\t\t* Get or Set the viewport element\n\t\t* @param {object} [options]\n\t\t* @param {string} [options.width]\n\t\t* @param {string} [options.height]\n\t\t* @param {string} [options.scale]\n\t\t* @param {string} [options.minimum]\n\t\t* @param {string} [options.maximum]\n\t\t* @param {string} [options.scalable]\n\t\t*/\n\tviewport(options) {\n\t\tvar _width, _height, _scale, _minimum, _maximum, _scalable;\n\t\t// var width, height, scale, minimum, maximum, scalable;\n\t\tvar $viewport = this.document.querySelector(\"meta[name='viewport']\");\n\t\tvar parsed = {\n\t\t\t\"width\": undefined,\n\t\t\t\"height\": undefined,\n\t\t\t\"scale\": undefined,\n\t\t\t\"minimum\": undefined,\n\t\t\t\"maximum\": undefined,\n\t\t\t\"scalable\": undefined\n\t\t};\n\t\tvar newContent = [];\n\t\tvar settings = {};\n\n\t\t/*\n\t\t* check for the viewport size\n\t\t* <meta name=\"viewport\" content=\"width=1024,height=697\" />\n\t\t*/\n\t\tif($viewport && $viewport.hasAttribute(\"content\")) {\n\t\t\tlet content = $viewport.getAttribute(\"content\");\n\t\t\tlet _width = content.match(/width\\s*=\\s*([^,]*)/);\n\t\t\tlet _height = content.match(/height\\s*=\\s*([^,]*)/);\n\t\t\tlet _scale = content.match(/initial-scale\\s*=\\s*([^,]*)/);\n\t\t\tlet _minimum = content.match(/minimum-scale\\s*=\\s*([^,]*)/);\n\t\t\tlet _maximum = content.match(/maximum-scale\\s*=\\s*([^,]*)/);\n\t\t\tlet _scalable = content.match(/user-scalable\\s*=\\s*([^,]*)/);\n\n\t\t\tif(_width && _width.length && typeof _width[1] !== \"undefined\"){\n\t\t\t\tparsed.width = _width[1];\n\t\t\t}\n\t\t\tif(_height && _height.length && typeof _height[1] !== \"undefined\"){\n\t\t\t\tparsed.height = _height[1];\n\t\t\t}\n\t\t\tif(_scale && _scale.length && typeof _scale[1] !== \"undefined\"){\n\t\t\t\tparsed.scale = _scale[1];\n\t\t\t}\n\t\t\tif(_minimum && _minimum.length && typeof _minimum[1] !== \"undefined\"){\n\t\t\t\tparsed.minimum = _minimum[1];\n\t\t\t}\n\t\t\tif(_maximum && _maximum.length && typeof _maximum[1] !== \"undefined\"){\n\t\t\t\tparsed.maximum = _maximum[1];\n\t\t\t}\n\t\t\tif(_scalable && _scalable.length && typeof _scalable[1] !== \"undefined\"){\n\t\t\t\tparsed.scalable = _scalable[1];\n\t\t\t}\n\t\t}\n\n\t\tsettings = defaults(options || {}, parsed);\n\n\t\tif (options) {\n\t\t\tif (settings.width) {\n\t\t\t\tnewContent.push(\"width=\" + settings.width);\n\t\t\t}\n\n\t\t\tif (settings.height) {\n\t\t\t\tnewContent.push(\"height=\" + settings.height);\n\t\t\t}\n\n\t\t\tif (settings.scale) {\n\t\t\t\tnewContent.push(\"initial-scale=\" + settings.scale);\n\t\t\t}\n\n\t\t\tif (settings.scalable === \"no\") {\n\t\t\t\tnewContent.push(\"minimum-scale=\" + settings.scale);\n\t\t\t\tnewContent.push(\"maximum-scale=\" + settings.scale);\n\t\t\t\tnewContent.push(\"user-scalable=\" + settings.scalable);\n\t\t\t} else {\n\n\t\t\t\tif (settings.scalable) {\n\t\t\t\t\tnewContent.push(\"user-scalable=\" + settings.scalable);\n\t\t\t\t}\n\n\t\t\t\tif (settings.minimum) {\n\t\t\t\t\tnewContent.push(\"minimum-scale=\" + settings.minimum);\n\t\t\t\t}\n\n\t\t\t\tif (settings.maximum) {\n\t\t\t\t\tnewContent.push(\"minimum-scale=\" + settings.maximum);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!$viewport) {\n\t\t\t\t$viewport = this.document.createElement(\"meta\");\n\t\t\t\t$viewport.setAttribute(\"name\", \"viewport\");\n\t\t\t\tthis.document.querySelector(\"head\").appendChild($viewport);\n\t\t\t}\n\n\t\t\t$viewport.setAttribute(\"content\", newContent.join(\", \"));\n\n\t\t\tthis.window.scrollTo(0, 0);\n\t\t}\n\n\n\t\treturn settings;\n\t}\n\n\t/**\n\t * Event emitter for when the contents has expanded\n\t * @private\n\t */\n\texpand() {\n\t\tthis.emit(EVENTS.CONTENTS.EXPAND);\n\t}\n\n\t/**\n\t * Add DOM listeners\n\t * @private\n\t */\n\tlisteners() {\n\t\tthis.imageLoadListeners();\n\n\t\tthis.mediaQueryListeners();\n\n\t\t// this.fontLoadListeners();\n\n\t\tthis.addEventListeners();\n\n\t\tthis.addSelectionListeners();\n\n\t\t// this.transitionListeners();\n\n\t\tif (typeof ResizeObserver === \"undefined\") {\n\t\t\tthis.resizeListeners();\n\t\t\tthis.visibilityListeners();\n\t\t} else {\n\t\t\tthis.resizeObservers();\n\t\t}\n\n\t\t// this.mutationObservers();\n\n\t\tthis.linksHandler();\n\t}\n\n\t/**\n\t * Remove DOM listeners\n\t * @private\n\t */\n\tremoveListeners() {\n\n\t\tthis.removeEventListeners();\n\n\t\tthis.removeSelectionListeners();\n\n\t\tif (this.observer) {\n\t\t\tthis.observer.disconnect();\n\t\t}\n\n\t\tclearTimeout(this.expanding);\n\t}\n\n\t/**\n\t * Check if size of contents has changed and\n\t * emit 'resize' event if it has.\n\t * @private\n\t */\n\tresizeCheck() {\n\t\tlet width = this.textWidth();\n\t\tlet height = this.textHeight();\n\n\t\tif (width != this._size.width || height != this._size.height) {\n\n\t\t\tthis._size = {\n\t\t\t\twidth: width,\n\t\t\t\theight: height\n\t\t\t};\n\n\t\t\tthis.onResize && this.onResize(this._size);\n\t\t\tthis.emit(EVENTS.CONTENTS.RESIZE, this._size);\n\t\t}\n\t}\n\n\t/**\n\t * Poll for resize detection\n\t * @private\n\t */\n\tresizeListeners() {\n\t\tvar width, height;\n\t\t// Test size again\n\t\tclearTimeout(this.expanding);\n\t\trequestAnimationFrame(this.resizeCheck.bind(this));\n\t\tthis.expanding = setTimeout(this.resizeListeners.bind(this), 350);\n\t}\n\n\t/**\n\t * Listen for visibility of tab to change\n\t * @private\n\t */\n\tvisibilityListeners() {\n\t\tdocument.addEventListener(\"visibilitychange\", () => {\n\t\t\tif (document.visibilityState === \"visible\" && this.active === false) {\n\t\t\t\tthis.active = true;\n\t\t\t\tthis.resizeListeners();\n\t\t\t} else {\n\t\t\t\tthis.active = false;\n\t\t\t\tclearTimeout(this.expanding);\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Use css transitions to detect resize\n\t * @private\n\t */\n\ttransitionListeners() {\n\t\tlet body = this.content;\n\n\t\tbody.style['transitionProperty'] = \"font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height\";\n\t\tbody.style['transitionDuration'] = \"0.001ms\";\n\t\tbody.style['transitionTimingFunction'] = \"linear\";\n\t\tbody.style['transitionDelay'] = \"0\";\n\n\t\tthis._resizeCheck = this.resizeCheck.bind(this);\n\t\tthis.document.addEventListener('transitionend', this._resizeCheck);\n\t}\n\n\t/**\n\t * Listen for media query changes and emit 'expand' event\n\t * Adapted from: https://github.com/tylergaw/media-query-events/blob/master/js/mq-events.js\n\t * @private\n\t */\n\tmediaQueryListeners() {\n\t\tvar sheets = this.document.styleSheets;\n\t\tvar mediaChangeHandler = function(m){\n\t\t\tif(m.matches && !this._expanding) {\n\t\t\t\tsetTimeout(this.expand.bind(this), 1);\n\t\t\t}\n\t\t}.bind(this);\n\n\t\tfor (var i = 0; i < sheets.length; i += 1) {\n\t\t\tvar rules;\n\t\t\t// Firefox errors if we access cssRules cross-domain\n\t\t\ttry {\n\t\t\t\trules = sheets[i].cssRules;\n\t\t\t} catch (e) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(!rules) return; // Stylesheets changed\n\t\t\tfor (var j = 0; j < rules.length; j += 1) {\n\t\t\t\t//if (rules[j].constructor === CSSMediaRule) {\n\t\t\t\tif(rules[j].media){\n\t\t\t\t\tvar mql = this.window.matchMedia(rules[j].media.mediaText);\n\t\t\t\t\tmql.addListener(mediaChangeHandler);\n\t\t\t\t\t//mql.onchange = mediaChangeHandler;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Use ResizeObserver to listen for changes in the DOM and check for resize\n\t * @private\n\t */\n\tresizeObservers() {\n\t\t// create an observer instance\n\t\tthis.observer = new ResizeObserver((e) => {\n\t\t\trequestAnimationFrame(this.resizeCheck.bind(this));\n\t\t});\n\n\t\t// pass in the target node\n\t\tthis.observer.observe(this.document.documentElement);\n\t}\n\n\t/**\n\t * Use MutationObserver to listen for changes in the DOM and check for resize\n\t * @private\n\t */\n\tmutationObservers() {\n\t\t// create an observer instance\n\t\tthis.observer = new MutationObserver((mutations) => {\n\t\t\tthis.resizeCheck();\n\t\t});\n\n\t\t// configuration of the observer:\n\t\tlet config = { attributes: true, childList: true, characterData: true, subtree: true };\n\n\t\t// pass in the target node, as well as the observer options\n\t\tthis.observer.observe(this.document, config);\n\t}\n\n\t/**\n\t * Test if images are loaded or add listener for when they load\n\t * @private\n\t */\n\timageLoadListeners() {\n\t\tvar images = this.document.querySelectorAll(\"img\");\n\t\tvar img;\n\t\tfor (var i = 0; i < images.length; i++) {\n\t\t\timg = images[i];\n\n\t\t\tif (typeof img.naturalWidth !== \"undefined\" &&\n\t\t\t\t\timg.naturalWidth === 0) {\n\t\t\t\timg.onload = this.expand.bind(this);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Listen for font load and check for resize when loaded\n\t * @private\n\t */\n\tfontLoadListeners() {\n\t\tif (!this.document || !this.document.fonts) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.document.fonts.ready.then(function () {\n\t\t\tthis.resizeCheck();\n\t\t}.bind(this));\n\n\t}\n\n\t/**\n\t * Get the documentElement\n\t * @returns {element} documentElement\n\t */\n\troot() {\n\t\tif(!this.document) return null;\n\t\treturn this.document.documentElement;\n\t}\n\n\t/**\n\t * Get the location offset of a EpubCFI or an #id\n\t * @param {string | EpubCFI} target\n\t * @param {string} [ignoreClass] for the cfi\n\t * @returns { {left: Number, top: Number }\n\t */\n\tlocationOf(target, ignoreClass) {\n\t\tvar position;\n\t\tvar targetPos = {\"left\": 0, \"top\": 0};\n\n\t\tif(!this.document) return targetPos;\n\n\t\tif(this.epubcfi.isCfiString(target)) {\n\t\t\tlet range = new EpubCFI(target).toRange(this.document, ignoreClass);\n\n\t\t\tif(range) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!range.endContainer ||\n\t\t\t\t\t\t(range.startContainer == range.endContainer\n\t\t\t\t\t\t&& range.startOffset == range.endOffset)) {\n\t\t\t\t\t\t// If the end for the range is not set, it results in collapsed becoming\n\t\t\t\t\t\t// true. This in turn leads to inconsistent behaviour when calling\n\t\t\t\t\t\t// getBoundingRect. Wrong bounds lead to the wrong page being displayed.\n\t\t\t\t\t\t// https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/15684911/\n\t\t\t\t\t\tlet pos = range.startContainer.textContent.indexOf(\" \", range.startOffset);\n\t\t\t\t\t\tif (pos == -1) {\n\t\t\t\t\t\t\tpos = range.startContainer.textContent.length;\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.setEnd(range.startContainer, pos);\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(\"setting end offset to start container length failed\", e);\n\t\t\t\t}\n\n\t\t\t\tif (range.startContainer.nodeType === Node.ELEMENT_NODE) {\n\t\t\t\t\tposition = range.startContainer.getBoundingClientRect();\n\t\t\t\t\ttargetPos.left = position.left;\n\t\t\t\t\ttargetPos.top = position.top;\n\t\t\t\t} else {\n\t\t\t\t\t// Webkit does not handle collapsed range bounds correctly\n\t\t\t\t\t// https://bugs.webkit.org/show_bug.cgi?id=138949\n\n\t\t\t\t\t// Construct a new non-collapsed range\n\t\t\t\t\tif (isWebkit) {\n\t\t\t\t\t\tlet container = range.startContainer;\n\t\t\t\t\t\tlet newRange = new Range();\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (container.nodeType === ELEMENT_NODE) {\n\t\t\t\t\t\t\t\tposition = container.getBoundingClientRect();\n\t\t\t\t\t\t\t} else if (range.startOffset + 2 < container.length) {\n\t\t\t\t\t\t\t\tnewRange.setStart(container, range.startOffset);\n\t\t\t\t\t\t\t\tnewRange.setEnd(container, range.startOffset + 2);\n\t\t\t\t\t\t\t\tposition = newRange.getBoundingClientRect();\n\t\t\t\t\t\t\t} else if (range.startOffset - 2 > 0) {\n\t\t\t\t\t\t\t\tnewRange.setStart(container, range.startOffset - 2);\n\t\t\t\t\t\t\t\tnewRange.setEnd(container, range.startOffset);\n\t\t\t\t\t\t\t\tposition = newRange.getBoundingClientRect();\n\t\t\t\t\t\t\t} else { // empty, return the parent element\n\t\t\t\t\t\t\t\tposition = container.parentNode.getBoundingClientRect();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tconsole.error(e, e.stack);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tposition = range.getBoundingClientRect();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else if(typeof target === \"string\" &&\n\t\t\ttarget.indexOf(\"#\") > -1) {\n\n\t\t\tlet id = target.substring(target.indexOf(\"#\")+1);\n\t\t\tlet el = this.document.getElementById(id);\n\t\t\tif(el) {\n\t\t\t\tif (isWebkit) {\n\t\t\t\t\t// Webkit reports incorrect bounding rects in Columns\n\t\t\t\t\tlet newRange = new Range();\n\t\t\t\t\tnewRange.selectNode(el);\n\t\t\t\t\tposition = newRange.getBoundingClientRect();\n\t\t\t\t} else {\n\t\t\t\t\tposition = el.getBoundingClientRect();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (position) {\n\t\t\ttargetPos.left = position.left;\n\t\t\ttargetPos.top = position.top;\n\t\t}\n\n\t\treturn targetPos;\n\t}\n\n\t/**\n\t * Append a stylesheet link to the document head\n\t * @param {string} src url\n\t */\n\taddStylesheet(src) {\n\t\treturn new Promise(function(resolve, reject){\n\t\t\tvar $stylesheet;\n\t\t\tvar ready = false;\n\n\t\t\tif(!this.document) {\n\t\t\t\tresolve(false);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Check if link already exists\n\t\t\t$stylesheet = this.document.querySelector(\"link[href='\"+src+\"']\");\n\t\t\tif ($stylesheet) {\n\t\t\t\tresolve(true);\n\t\t\t\treturn; // already present\n\t\t\t}\n\n\t\t\t$stylesheet = this.document.createElement(\"link\");\n\t\t\t$stylesheet.type = \"text/css\";\n\t\t\t$stylesheet.rel = \"stylesheet\";\n\t\t\t$stylesheet.href = src;\n\t\t\t$stylesheet.onload = $stylesheet.onreadystatechange = function() {\n\t\t\t\tif ( !ready && (!this.readyState || this.readyState == \"complete\") ) {\n\t\t\t\t\tready = true;\n\t\t\t\t\t// Let apply\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tresolve(true);\n\t\t\t\t\t}, 1);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.document.head.appendChild($stylesheet);\n\n\t\t}.bind(this));\n\t}\n\n\t_getStylesheetNode(key) {\n\t\tvar styleEl;\n\t\tkey = \"epubjs-inserted-css-\" + (key || '');\n\n\t\tif(!this.document) return false;\n\n\t\t// Check if link already exists\n\t\tstyleEl = this.document.getElementById(key);\n\t\tif (!styleEl) {\n\t\t\tstyleEl = this.document.createElement(\"style\");\n\t\t\tstyleEl.id = key;\n\t\t\t// Append style element to head\n\t\t\tthis.document.head.appendChild(styleEl);\n\t\t}\n\t\treturn styleEl;\n\t}\n\n\t/**\n\t * Append stylesheet css\n\t * @param {string} serializedCss\n\t * @param {string} key If the key is the same, the CSS will be replaced instead of inserted\n\t */\n\taddStylesheetCss(serializedCss, key) {\n\t\tif(!this.document || !serializedCss) return false;\n\n\t\tvar styleEl;\n\t\tstyleEl = this._getStylesheetNode(key);\n\t\tstyleEl.innerHTML = serializedCss;\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Append stylesheet rules to a generate stylesheet\n\t * Array: https://developer.mozilla.org/en-US/docs/Web/API/CSSStyleSheet/insertRule\n\t * Object: https://github.com/desirable-objects/json-to-css\n\t * @param {array | object} rules\n\t * @param {string} key If the key is the same, the CSS will be replaced instead of inserted\n\t */\n\taddStylesheetRules(rules, key) {\n\t\tvar styleSheet;\n\n\t\tif(!this.document || !rules || rules.length === 0) return;\n\n\t\t// Grab style sheet\n\t\tstyleSheet = this._getStylesheetNode(key).sheet;\n\n\t\tif (Object.prototype.toString.call(rules) === \"[object Array]\") {\n\t\t\tfor (var i = 0, rl = rules.length; i < rl; i++) {\n\t\t\t\tvar j = 1, rule = rules[i], selector = rules[i][0], propStr = \"\";\n\t\t\t\t// If the second argument of a rule is an array of arrays, correct our variables.\n\t\t\t\tif (Object.prototype.toString.call(rule[1][0]) === \"[object Array]\") {\n\t\t\t\t\trule = rule[1];\n\t\t\t\t\tj = 0;\n\t\t\t\t}\n\n\t\t\t\tfor (var pl = rule.length; j < pl; j++) {\n\t\t\t\t\tvar prop = rule[j];\n\t\t\t\t\tpropStr += prop[0] + \":\" + prop[1] + (prop[2] ? \" !important\" : \"\") + \";\\n\";\n\t\t\t\t}\n\n\t\t\t\t// Insert CSS Rule\n\t\t\t\tstyleSheet.insertRule(selector + \"{\" + propStr + \"}\", styleSheet.cssRules.length);\n\t\t\t}\n\t\t} else {\n\t\t\tconst selectors = Object.keys(rules);\n\t\t\tselectors.forEach((selector) => {\n\t\t\t\tconst definition = rules[selector];\n\t\t\t\tif (Array.isArray(definition)) {\n\t\t\t\t\tdefinition.forEach((item) => {\n\t\t\t\t\t\tconst _rules = Object.keys(item);\n\t\t\t\t\t\tconst result = _rules.map((rule) => {\n\t\t\t\t\t\t\treturn `${rule}:${item[rule]}`;\n\t\t\t\t\t\t}).join(';');\n\t\t\t\t\t\tstyleSheet.insertRule(`${selector}{${result}}`, styleSheet.cssRules.length);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tconst _rules = Object.keys(definition);\n\t\t\t\t\tconst result = _rules.map((rule) => {\n\t\t\t\t\t\treturn `${rule}:${definition[rule]}`;\n\t\t\t\t\t}).join(';');\n\t\t\t\t\tstyleSheet.insertRule(`${selector}{${result}}`, styleSheet.cssRules.length);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Append a script tag to the document head\n\t * @param {string} src url\n\t * @returns {Promise} loaded\n\t */\n\taddScript(src) {\n\n\t\treturn new Promise(function(resolve, reject){\n\t\t\tvar $script;\n\t\t\tvar ready = false;\n\n\t\t\tif(!this.document) {\n\t\t\t\tresolve(false);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$script = this.document.createElement(\"script\");\n\t\t\t$script.type = \"text/javascript\";\n\t\t\t$script.async = true;\n\t\t\t$script.src = src;\n\t\t\t$script.onload = $script.onreadystatechange = function() {\n\t\t\t\tif ( !ready && (!this.readyState || this.readyState == \"complete\") ) {\n\t\t\t\t\tready = true;\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\tresolve(true);\n\t\t\t\t\t}, 1);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.document.head.appendChild($script);\n\n\t\t}.bind(this));\n\t}\n\n\t/**\n\t * Add a class to the contents container\n\t * @param {string} className\n\t */\n\taddClass(className) {\n\t\tvar content;\n\n\t\tif(!this.document) return;\n\n\t\tcontent = this.content || this.document.body;\n\n\t\tif (content) {\n\t\t\tcontent.classList.add(className);\n\t\t}\n\n\t}\n\n\t/**\n\t * Remove a class from the contents container\n\t * @param {string} removeClass\n\t */\n\tremoveClass(className) {\n\t\tvar content;\n\n\t\tif(!this.document) return;\n\n\t\tcontent = this.content || this.document.body;\n\n\t\tif (content) {\n\t\t\tcontent.classList.remove(className);\n\t\t}\n\n\t}\n\n\t/**\n\t * Add DOM event listeners\n\t * @private\n\t */\n\taddEventListeners(){\n\t\tif(!this.document) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._triggerEvent = this.triggerEvent.bind(this);\n\n\t\tDOM_EVENTS.forEach(function(eventName){\n\t\t\tthis.document.addEventListener(eventName, this._triggerEvent, { passive: true });\n\t\t}, this);\n\n\t}\n\n\t/**\n\t * Remove DOM event listeners\n\t * @private\n\t */\n\tremoveEventListeners(){\n\t\tif(!this.document) {\n\t\t\treturn;\n\t\t}\n\t\tDOM_EVENTS.forEach(function(eventName){\n\t\t\tthis.document.removeEventListener(eventName, this._triggerEvent, { passive: true });\n\t\t}, this);\n\t\tthis._triggerEvent = undefined;\n\t}\n\n\t/**\n\t * Emit passed browser events\n\t * @private\n\t */\n\ttriggerEvent(e){\n\t\tthis.emit(e.type, e);\n\t}\n\n\t/**\n\t * Add listener for text selection\n\t * @private\n\t */\n\taddSelectionListeners(){\n\t\tif(!this.document) {\n\t\t\treturn;\n\t\t}\n\t\tthis._onSelectionChange = this.onSelectionChange.bind(this);\n\t\tthis.document.addEventListener(\"selectionchange\", this._onSelectionChange, { passive: true });\n\t}\n\n\t/**\n\t * Remove listener for text selection\n\t * @private\n\t */\n\tremoveSelectionListeners(){\n\t\tif(!this.document) {\n\t\t\treturn;\n\t\t}\n\t\tthis.document.removeEventListener(\"selectionchange\", this._onSelectionChange, { passive: true });\n\t\tthis._onSelectionChange = undefined;\n\t}\n\n\t/**\n\t * Handle getting text on selection\n\t * @private\n\t */\n\tonSelectionChange(e){\n\t\tif (this.selectionEndTimeout) {\n\t\t\tclearTimeout(this.selectionEndTimeout);\n\t\t}\n\t\tthis.selectionEndTimeout = setTimeout(function() {\n\t\t\tvar selection = this.window.getSelection();\n\t\t\tthis.triggerSelectedEvent(selection);\n\t\t}.bind(this), 250);\n\t}\n\n\t/**\n\t * Emit event on text selection\n\t * @private\n\t */\n\ttriggerSelectedEvent(selection){\n\t\tvar range, cfirange;\n\n\t\tif (selection && selection.rangeCount > 0) {\n\t\t\trange = selection.getRangeAt(0);\n\t\t\tif(!range.collapsed) {\n\t\t\t\t// cfirange = this.section.cfiFromRange(range);\n\t\t\t\tcfirange = new EpubCFI(range, this.cfiBase).toString();\n\t\t\t\tthis.emit(EVENTS.CONTENTS.SELECTED, cfirange);\n\t\t\t\tthis.emit(EVENTS.CONTENTS.SELECTED_RANGE, range);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Get a Dom Range from EpubCFI\n\t * @param {EpubCFI} _cfi\n\t * @param {string} [ignoreClass]\n\t * @returns {Range} range\n\t */\n\trange(_cfi, ignoreClass){\n\t\tvar cfi = new EpubCFI(_cfi);\n\t\treturn cfi.toRange(this.document, ignoreClass);\n\t}\n\n\t/**\n\t * Get an EpubCFI from a Dom Range\n\t * @param {Range} range\n\t * @param {string} [ignoreClass]\n\t * @returns {EpubCFI} cfi\n\t */\n\tcfiFromRange(range, ignoreClass){\n\t\treturn new EpubCFI(range, this.cfiBase, ignoreClass).toString();\n\t}\n\n\t/**\n\t * Get an EpubCFI from a Dom node\n\t * @param {node} node\n\t * @param {string} [ignoreClass]\n\t * @returns {EpubCFI} cfi\n\t */\n\tcfiFromNode(node, ignoreClass){\n\t\treturn new EpubCFI(node, this.cfiBase, ignoreClass).toString();\n\t}\n\n\t// TODO: find where this is used - remove?\n\tmap(layout){\n\t\tvar map = new Mapping(layout);\n\t\treturn map.section();\n\t}\n\n\t/**\n\t * Size the contents to a given width and height\n\t * @param {number} [width]\n\t * @param {number} [height]\n\t */\n\tsize(width, height){\n\t\tvar viewport = { scale: 1.0, scalable: \"no\" };\n\n\t\tthis.layoutStyle(\"scrolling\");\n\n\t\tif (width >= 0) {\n\t\t\tthis.width(width);\n\t\t\tviewport.width = width;\n\t\t\tthis.css(\"padding\", \"0 \"+(width/12)+\"px\");\n\t\t}\n\n\t\tif (height >= 0) {\n\t\t\tthis.height(height);\n\t\t\tviewport.height = height;\n\t\t}\n\n\t\tthis.css(\"margin\", \"0\");\n\t\tthis.css(\"box-sizing\", \"border-box\");\n\n\n\t\tthis.viewport(viewport);\n\t}\n\n\t/**\n\t * Apply columns to the contents for pagination\n\t * @param {number} width\n\t * @param {number} height\n\t * @param {number} columnWidth\n\t * @param {number} gap\n\t */\n\tcolumns(width, height, columnWidth, gap, dir){\n\t\tlet COLUMN_AXIS = prefixed(\"column-axis\");\n\t\tlet COLUMN_GAP = prefixed(\"column-gap\");\n\t\tlet COLUMN_WIDTH = prefixed(\"column-width\");\n\t\tlet COLUMN_FILL = prefixed(\"column-fill\");\n\n\t\tlet writingMode = this.writingMode();\n\t\tlet axis = (writingMode.indexOf(\"vertical\") === 0) ? \"vertical\" : \"horizontal\";\n\n\t\tthis.layoutStyle(\"paginated\");\n\n\t\tif (dir === \"rtl\" && axis === \"horizontal\") {\n\t\t\tthis.direction(dir);\n\t\t}\n\n\t\tthis.width(width);\n\t\tthis.height(height);\n\n\t\t// Deal with Mobile trying to scale to viewport\n\t\tthis.viewport({ width: width, height: height, scale: 1.0, scalable: \"no\" });\n\n\t\t// TODO: inline-block needs more testing\n\t\t// Fixes Safari column cut offs, but causes RTL issues\n\t\t// this.css(\"display\", \"inline-block\");\n\n\t\tthis.css(\"overflow-y\", \"hidden\");\n\t\tthis.css(\"margin\", \"0\", true);\n\n\t\tif (axis === \"vertical\") {\n\t\t\tthis.css(\"padding-top\", (gap / 2) + \"px\", true);\n\t\t\tthis.css(\"padding-bottom\", (gap / 2) + \"px\", true);\n\t\t\tthis.css(\"padding-left\", \"20px\");\n\t\t\tthis.css(\"padding-right\", \"20px\");\n\t\t\tthis.css(COLUMN_AXIS, \"vertical\");\n\t\t} else {\n\t\t\tthis.css(\"padding-top\", \"20px\");\n\t\t\tthis.css(\"padding-bottom\", \"20px\");\n\t\t\tthis.css(\"padding-left\", (gap / 2) + \"px\", true);\n\t\t\tthis.css(\"padding-right\", (gap / 2) + \"px\", true);\n\t\t\tthis.css(COLUMN_AXIS, \"horizontal\");\n\t\t}\n\n\t\tthis.css(\"box-sizing\", \"border-box\");\n\t\tthis.css(\"max-width\", \"inherit\");\n\n\t\tthis.css(COLUMN_FILL, \"auto\");\n\n\t\tthis.css(COLUMN_GAP, gap+\"px\");\n\t\tthis.css(COLUMN_WIDTH, columnWidth+\"px\");\n\n\t\t// Fix glyph clipping in WebKit\n\t\t// https://github.com/futurepress/epub.js/issues/983\n\t\tthis.css(\"-webkit-line-box-contain\", \"block glyphs replaced\");\n\t}\n\n\t/**\n\t * Scale contents from center\n\t * @param {number} scale\n\t * @param {number} offsetX\n\t * @param {number} offsetY\n\t */\n\tscaler(scale, offsetX, offsetY){\n\t\tvar scaleStr = \"scale(\" + scale + \")\";\n\t\tvar translateStr = \"\";\n\t\t// this.css(\"position\", \"absolute\"));\n\t\tthis.css(\"transform-origin\", \"top left\");\n\n\t\tif (offsetX >= 0 || offsetY >= 0) {\n\t\t\ttranslateStr = \" translate(\" + (offsetX || 0 )+ \"px, \" + (offsetY || 0 )+ \"px )\";\n\t\t}\n\n\t\tthis.css(\"transform\", scaleStr + translateStr);\n\t}\n\n\t/**\n\t * Fit contents into a fixed width and height\n\t * @param {number} width\n\t * @param {number} height\n\t */\n\tfit(width, height, section){\n\t\tvar viewport = this.viewport();\n\t\tvar viewportWidth = parseInt(viewport.width);\n\t\tvar viewportHeight = parseInt(viewport.height);\n\t\tvar widthScale = width / viewportWidth;\n\t\tvar heightScale = height / viewportHeight;\n\t\tvar scale = widthScale < heightScale ? widthScale : heightScale;\n\n\t\t// the translate does not work as intended, elements can end up unaligned\n\t\t// var offsetY = (height - (viewportHeight * scale)) / 2;\n\t\t// var offsetX = 0;\n\t\t// if (this.sectionIndex % 2 === 1) {\n\t\t// \toffsetX = width - (viewportWidth * scale);\n\t\t// }\n\n\t\tthis.layoutStyle(\"paginated\");\n\n\t\t// scale needs width and height to be set\n\t\tthis.width(viewportWidth);\n\t\tthis.height(viewportHeight);\n\t\tthis.overflow(\"hidden\");\n\n\t\t// Scale to the correct size\n\t\tthis.scaler(scale, 0, 0);\n\t\t// this.scaler(scale, offsetX > 0 ? offsetX : 0, offsetY);\n\n\t\t// background images are not scaled by transform\n\t\tthis.css(\"background-size\", viewportWidth * scale + \"px \" + viewportHeight * scale + \"px\");\n\n\t\tthis.css(\"background-color\", \"transparent\");\n\t\tif (section && section.properties.includes(\"page-spread-left\")) {\n\t\t\t// set margin since scale is weird\n\t\t\tvar marginLeft = width - (viewportWidth * scale);\n\t\t\tthis.css(\"margin-left\", marginLeft + \"px\");\n\t\t}\n\t}\n\n\t/**\n\t * Set the direction of the text\n\t * @param {string} [dir=\"ltr\"] \"rtl\" | \"ltr\"\n\t */\n\tdirection(dir) {\n\t\tif (this.documentElement) {\n\t\t\tthis.documentElement.style[\"direction\"] = dir;\n\t\t}\n\t}\n\n\tmapPage(cfiBase, layout, start, end, dev) {\n\t\tvar mapping = new Mapping(layout, dev);\n\n\t\treturn mapping.page(this, cfiBase, start, end);\n\t}\n\n\t/**\n\t * Emit event when link in content is clicked\n\t * @private\n\t */\n\tlinksHandler() {\n\t\treplaceLinks(this.content, (href) => {\n\t\t\tthis.emit(EVENTS.CONTENTS.LINK_CLICKED, href);\n\t\t});\n\t}\n\n\t/**\n\t * Set the writingMode of the text\n\t * @param {string} [mode=\"horizontal-tb\"] \"horizontal-tb\" | \"vertical-rl\" | \"vertical-lr\"\n\t */\n\twritingMode(mode) {\n\t\tlet WRITING_MODE = prefixed(\"writing-mode\");\n\n\t\tif (mode && this.documentElement) {\n\t\t\tthis.documentElement.style[WRITING_MODE] = mode;\n\t\t}\n\n\t\treturn this.window.getComputedStyle(this.documentElement)[WRITING_MODE] || '';\n\t}\n\n\t/**\n\t * Set the layoutStyle of the content\n\t * @param {string} [style=\"paginated\"] \"scrolling\" | \"paginated\"\n\t * @private\n\t */\n\tlayoutStyle(style) {\n\n\t\tif (style) {\n\t\t\tthis._layoutStyle = style;\n\t\t\tnavigator.epubReadingSystem.layoutStyle = this._layoutStyle;\n\t\t}\n\n\t\treturn this._layoutStyle || \"paginated\";\n\t}\n\n\t/**\n\t * Add the epubReadingSystem object to the navigator\n\t * @param {string} name\n\t * @param {string} version\n\t * @private\n\t */\n\tepubReadingSystem(name, version) {\n\t\tnavigator.epubReadingSystem = {\n\t\t\tname: name,\n\t\t\tversion: version,\n\t\t\tlayoutStyle: this.layoutStyle(),\n\t\t\thasFeature: function (feature) {\n\t\t\t\tswitch (feature) {\n\t\t\t\t\tcase \"dom-manipulation\":\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase \"layout-changes\":\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase \"touch-events\":\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase \"mouse-events\":\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase \"keyboard-events\":\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tcase \"spine-scripting\":\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn navigator.epubReadingSystem;\n\t}\n\n\tdestroy() {\n\t\t// this.document.removeEventListener('transitionend', this._resizeCheck);\n\n\t\tthis.removeListeners();\n\n\t}\n}\n\nEventEmitter(Contents.prototype);\n\nexport default Contents;\n"],"names":["hasNavigator","isChrome","isWebkit","ELEMENT_NODE","Contents","doc","content","cfiBase","sectionIndex","EpubCFI","EPUBJS_VERSION","DOM_EVENTS","w","frame","isNumber","h","rect","width","range","border","borders","height","overflow","property","value","priority","options","$viewport","parsed","newContent","settings","_width","_height","_scale","_minimum","_maximum","_scalable","defaults","EVENTS","body","sheets","mediaChangeHandler","m","rules","j","mql","mutations","config","images","img","target","ignoreClass","position","targetPos","pos","e","container","newRange","id","el","src","resolve","reject","$stylesheet","ready","key","styleEl","serializedCss","styleSheet","i","rl","rule","selector","propStr","pl","prop","definition","item","result","$script","className","eventName","selection","cfirange","_cfi","cfi","node","layout","map","Mapping","viewport","columnWidth","gap","dir","COLUMN_AXIS","prefixed","COLUMN_GAP","COLUMN_WIDTH","COLUMN_FILL","axis","scale","offsetX","offsetY","scaleStr","translateStr","section","viewportWidth","viewportHeight","widthScale","heightScale","marginLeft","start","end","dev","mapping","replaceLinks","href","mode","WRITING_MODE","style","name","version","feature","EventEmitter"],"mappings":"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","x_google_ignoreList":[0]}