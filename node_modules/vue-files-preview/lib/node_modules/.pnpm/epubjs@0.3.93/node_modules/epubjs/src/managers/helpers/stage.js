"use strict";const s=require("../../utils/core.js"),a=require("../../../../../../lodash@4.17.21/node_modules/lodash/throttle.js");class d{constructor(t){this.settings=t||{},this.id="epubjs-container-"+s.uuid(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(t){let e=t.height,n=t.width,l=t.overflow||!1,o=t.axis||"vertical",r=t.direction;s.extend(this.settings,t),t.height&&s.isNumber(t.height)&&(e=t.height+"px"),t.width&&s.isNumber(t.width)&&(n=t.width+"px");let i=document.createElement("div");return i.id=this.id,i.classList.add("epub-container"),i.style.wordSpacing="0",i.style.lineHeight="0",i.style.verticalAlign="top",i.style.position="relative",o==="horizontal"&&(i.style.display="flex",i.style.flexDirection="row",i.style.flexWrap="nowrap"),n&&(i.style.width=n),e&&(i.style.height=e),l&&(l==="scroll"&&o==="vertical"?(i.style["overflow-y"]=l,i.style["overflow-x"]="hidden"):l==="scroll"&&o==="horizontal"?(i.style["overflow-y"]="hidden",i.style["overflow-x"]=l):i.style.overflow=l),r&&(i.dir=r,i.style.direction=r),r&&this.settings.fullsize&&(document.body.style.direction=r),i}wrap(t){var e=document.createElement("div");return e.style.visibility="hidden",e.style.overflow="hidden",e.style.width="0",e.style.height="0",e.appendChild(t),e}getElement(t){var e;if(s.isElement(t)?e=t:typeof t=="string"&&(e=document.getElementById(t)),!e)throw new Error("Not an Element");return e}attachTo(t){var e=this.getElement(t),n;if(e)return this.settings.hidden?n=this.wrapper:n=this.container,e.appendChild(n),this.element=e,e}getContainer(){return this.container}onResize(t){(!s.isNumber(this.settings.width)||!s.isNumber(this.settings.height))&&(this.resizeFunc=a(t,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(t){this.orientationChangeFunc=t,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(t,e){var n;let l=t||this.settings.width,o=e||this.settings.height;t===null?(n=this.element.getBoundingClientRect(),n.width&&(t=Math.floor(n.width),this.container.style.width=t+"px")):s.isNumber(t)?this.container.style.width=t+"px":this.container.style.width=t,e===null?(n=n||this.element.getBoundingClientRect(),n.height&&(e=n.height,this.container.style.height=e+"px")):s.isNumber(e)?this.container.style.height=e+"px":this.container.style.height=e,s.isNumber(t)||(t=this.container.clientWidth),s.isNumber(e)||(e=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let r=s.windowBounds(),i=window.getComputedStyle(document.body),h={left:parseFloat(i["padding-left"])||0,right:parseFloat(i["padding-right"])||0,top:parseFloat(i["padding-top"])||0,bottom:parseFloat(i["padding-bottom"])||0};return l||(t=r.width-h.left-h.right),(this.settings.fullsize&&!o||!o)&&(e=r.height-h.top-h.bottom),{width:t-this.containerPadding.left-this.containerPadding.right,height:e-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let t;return this.container.style.overflow!=="visible"&&(t=this.container&&this.container.getBoundingClientRect()),!t||!t.width||!t.height?s.windowBounds():t}getSheet(){var t=document.createElement("style");return t.appendChild(document.createTextNode("")),document.head.appendChild(t),t.sheet}addStyleRules(t,e){var n="#"+this.id+" ",l="";this.sheet||(this.sheet=this.getSheet()),e.forEach(function(o){for(var r in o)o.hasOwnProperty(r)&&(l+=r+":"+o[r]+";")}),this.sheet.insertRule(n+t+" {"+l+"}",0)}axis(t){t==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=t}direction(t){this.container&&(this.container.dir=t,this.container.style.direction=t),this.settings.fullsize&&(document.body.style.direction=t),this.settings.dir=t}overflow(t){this.container&&(t==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=t,this.container.style["overflow-x"]="hidden"):t==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=t):this.container.style.overflow=t),this.settings.overflow=t}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}module.exports=d;
//# sourceMappingURL=stage.js.map
